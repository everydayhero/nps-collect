#!/bin/bash

set -euo pipefail

DEPLOY_ENV="$1" && shift
export JEFFREY_TOKEN=$JEFFREY_TOKEN_STAGING
export BUCKET=$BUCKET_STAGING
export BUCKET_PREFIX=$PREFIX_STAGING
export AWS_KEY=$AWS_KEY_STAGING
export AWS_SECRET=$AWS_SECRET_STAGING

if [ $DEPLOY_ENV == "production" ]; then
  export JEFFREY_TOKEN=$JEFFREY_TOKEN_PRODUCTION
  export BUCKET=$BUCKET_PRODUCTION
  export BUCKET_PREFIX=$PREFIX_PRODUCTION
  export AWS_KEY=$AWS_KEY_PRODUCTION
  export AWS_SECRET=$AWS_SECRET_PRODUCTION
fi

# Deploy assets
yarn run build
yarn run deploy
